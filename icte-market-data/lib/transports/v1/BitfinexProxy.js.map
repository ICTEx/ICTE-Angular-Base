{"version":3,"sources":["lib.js"],"names":["__extends","_0x5239ef","_0x3649cc","_0x5cc8fb","Object","Array","_0x273cb5","_0x49d231","_0x2244d6","_0x1fc70e","exports","EventEmiter","require","BitfinexConstant_1","WebSocket","BitfinexProxy","_0x261adb","_0x1f07cb","_0x156f1c","_0x119677","_0x32e134","_0x497d91","_0x1d0dc8","_0xe05a5a","_0x54327c","JSON","_0x797b45","_0x17e88c","_0x88dcbf","_0x409b29","_0x401837","_0x4d4a35","_0x176840","_0x2937e0","undefined"],"mappings":"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","sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EventEmiter = require(\"events\");\r\nvar BitfinexConstant_1 = require(\"./BitfinexConstant\");\r\nvar WebSocket = require('isomorphic-ws');\r\nvar BitfinexProxy = /** @class */ (function (_super) {\r\n    __extends(BitfinexProxy, _super);\r\n    function BitfinexProxy() {\r\n        var _this = _super.call(this) || this;\r\n        _this.wsState = WebSocket.CLOSE;\r\n        _this._channels = {};\r\n        var url = BitfinexConstant_1.BitfinexConstant.baseEndpoint;\r\n        _this.webSocket = new WebSocket(url);\r\n        _this.webSocket.onopen = function (e) {\r\n            _this.wsState = e.target.readyState;\r\n            _this.emit(BitfinexConstant_1.BitfinexConstant.OPENEVENT, \"Connected\");\r\n            _this.subscribe();\r\n        };\r\n        _this.webSocket.onclose = function (closeEvent) {\r\n            _this.emit(BitfinexConstant_1.BitfinexConstant.CLOSEEVENT, closeEvent);\r\n        };\r\n        _this.webSocket.onerror = function (errorEvent) {\r\n            _this.emit(BitfinexConstant_1.BitfinexConstant.ERROREVENT, errorEvent);\r\n        };\r\n        _this.webSocket.onmessage = function (receive) {\r\n            var data = JSON.parse(receive.data);\r\n            if (!Array.isArray(data)) {\r\n                var event = data.event;\r\n                switch (event) {\r\n                    case 'ping':\r\n                        _this.webSocket.send(BitfinexConstant_1.BitfinexConstant.pong);\r\n                        break;\r\n                    case 'subscribed':\r\n                        if (data.channel == 'ticker') {\r\n                            _this._channels[data.chanId] = data.pair;\r\n                            _this.emit(BitfinexConstant_1.BitfinexConstant.SUBSCRIBEDEVENT, data);\r\n                        }\r\n                        break;\r\n                    case 'error':\r\n                        _this.emit(BitfinexConstant_1.BitfinexConstant.ERROREVENT, data);\r\n                        break;\r\n                    case 'info':\r\n                        _this.chkInfoMsg(data.code, data.msg);\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                _this.processMsg(data);\r\n            }\r\n        };\r\n        return _this;\r\n    }\r\n    BitfinexProxy.prototype.subscribe = function () {\r\n        for (var key in BitfinexConstant_1.BitfinexConstant.PAIRS) {\r\n            var subscription = '{event: \"subscribe\", channel: \"ticker\", pair: \"' + key + '\"}';\r\n            this.webSocket.send(subscription);\r\n        }\r\n    };\r\n    BitfinexProxy.prototype.chkInfoMsg = function (infoId, infoMsg) {\r\n    };\r\n    BitfinexProxy.prototype.processMsg = function (msg) {\r\n        if (msg[1] != 'hb') {\r\n            var id = msg[BitfinexConstant_1.BitfinexConstant.MSG_CHANNEL_ID];\r\n            var symbol = this._channels[id];\r\n            if (symbol != undefined) {\r\n                this.emit(BitfinexConstant_1.BitfinexConstant.TICKEREVENT, symbol, msg);\r\n            }\r\n        }\r\n    };\r\n    return BitfinexProxy;\r\n}(EventEmiter)); //EOC\r\nexports.BitfinexProxy = BitfinexProxy;\r\n"]}