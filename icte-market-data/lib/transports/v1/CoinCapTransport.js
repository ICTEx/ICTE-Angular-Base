'use strict';Object['defineProperty'](exports,'__esModule',{'value':!![]});var CoinCapConstant_1=require('./CoinCapConstant');var MsgFactory_1=require('./MsgFactory');var MdConstant_1=require('../api/MdConstant');var MdUtils_1=require('../api/MdUtils');var WebSocket=require('isomorphic-ws');var CoinCapTransport=function(){var _0x5a9e86={};_0x5a9e86['Gfnlv']=function(_0x327659,_0x1e39ca){return _0x327659<_0x1e39ca;};_0x5a9e86['NEtHM']=function(_0x3d1262,_0x44c400){return _0x3d1262>=_0x44c400;};_0x5a9e86['wOacE']='4|3|0|1|2';_0x5a9e86['JgDkB']=function(_0x35fc00,_0x1adf8d){return _0x35fc00+_0x1adf8d;};_0x5a9e86['vkzLX']='wss://ws.coincap.io/prices?assets=';_0x5a9e86['lfrot']=function(_0x51deba,_0x325b87){return _0x51deba/_0x325b87;};function _0x28a5fb(_0x389522){var _0x124d4b=this;this['subscriptions']={};this['validIdList']=[];this['_connected']=![];this['isConnected']=function(){return _0x124d4b['_connected'];};this['connect']=function(_0x5186cc){_0x124d4b['_connected']=!![];_0x124d4b['subscribe'](_0x5186cc);_0x124d4b['setup']();};this['cb']=_0x389522;}_0x28a5fb['prototype']['subscribe']=function(_0x13e2cf){var _0x5cb047='';var _0x11a766=!![];for(var _0x3706c0=0x0;_0x5a9e86['Gfnlv'](_0x3706c0,CoinCapConstant_1['CoinCapConstant']['VALIDCOINS']['length']);_0x3706c0++){var _0x1e865a=CoinCapConstant_1['CoinCapConstant']['VALIDCOINS'][_0x3706c0]['symbol'];var _0x365805=MdConstant_1['MdConstant']['COINS']['indexOf'](_0x1e865a);var _0x5d3af9=CoinCapConstant_1['CoinCapConstant']['VALIDCOINS'][_0x3706c0]['id'];if(_0x5a9e86['NEtHM'](_0x365805,0x0)){var _0x1f868a=_0x5a9e86['wOacE']['split']('|'),_0x4b5bf4=0x0;while(!![]){switch(_0x1f868a[_0x4b5bf4++]){case'0':if(!_0x11a766){_0x5cb047+=',';}continue;case'1':_0x11a766=![];continue;case'2':_0x5cb047+=_0x5d3af9;continue;case'3':this['subscriptions'][_0x5d3af9]={};this['subscriptions'][_0x5d3af9]['symbol']=_0x1e865a;this['subscriptions'][_0x5d3af9]['id']=_0x365805;continue;case'4':this['validIdList'][CoinCapConstant_1['CoinCapConstant']['VALIDCOINS'][_0x3706c0]['id']]=_0x1e865a;continue;}break;}}}this['coinCapUri']=_0x5a9e86['JgDkB'](_0x5a9e86['vkzLX'],_0x5cb047);};_0x28a5fb['prototype']['setup']=function(){var _0x2d40c6={};_0x2d40c6['ToMYw']=function(_0x5cf035,_0x4734b1){return _0x5a9e86.lfrot(_0x5cf035,_0x4734b1);};_0x2d40c6['ladPv']=function(_0x2f53c1,_0xfbe61d){return _0x2f53c1%_0xfbe61d;};var _0x4434b1=this;this['socket']=new WebSocket(this['coinCapUri']);this['socket']['onmessage']=function(_0x3b6679){var _0x3c6ec1=MsgFactory_1['MsgFactory']['priceMsg'];var _0x28bdc4=JSON['parse'](_0x3b6679['data']);var _0x55ff4c=Object['keys'](_0x28bdc4);_0x55ff4c['forEach'](function(_0x3ad3b3){var _0x295193=_0x2d40c6['ToMYw'](Math['trunc'](_0x28bdc4[_0x3ad3b3]*CoinCapConstant_1['CoinCapConstant']['DIV']),CoinCapConstant_1['CoinCapConstant']['DIV']);_0x3c6ec1['buffer'](MdUtils_1['MdUtils']['getMsSinceMidnight'](),_0x4434b1['subscriptions'][_0x3ad3b3]['id'],Math['trunc'](_0x295193),Math['trunc'](_0x2d40c6['ladPv'](_0x295193,0x1)*CoinCapConstant_1['CoinCapConstant']['DIV']),0x0,0x0,0x0,0x0,MdConstant_1['MdConstant']['CoinCapTransport'],0x0);_0x4434b1['cb']['on'](_0x3c6ec1);});};};return _0x28a5fb;}();exports['CoinCapTransport']=CoinCapTransport;