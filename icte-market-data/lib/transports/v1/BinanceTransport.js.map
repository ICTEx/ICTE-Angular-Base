{"version":3,"sources":["lib.js"],"names":["Object","exports","BinanceProxy_1","require","BinanceConstant_1","MsgFactory_1","MdConstant_1","MdUtils_1","BinanceTransport","_0x1ae074","_0x5461fc","_0x30ed38","_0x3a776a","_0x1a769a","_0x45309c","_0x510fae","_0x203c42","_0x30f569","_0x566c0d","_0x816685","_0x5b99d5","_0xac9e69","Math","_0x2c3fda","_0x96f398","_0x5fd97d","_0x3c9685"],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar BinanceProxy_1 = require(\"./BinanceProxy\");\r\nvar BinanceConstant_1 = require(\"./BinanceConstant\");\r\nvar MsgFactory_1 = require(\"./MsgFactory\");\r\nvar MdConstant_1 = require(\"../api/MdConstant\");\r\nvar MdUtils_1 = require(\"../api/MdUtils\");\r\nvar BinanceTransport = /** @class */ (function () {\r\n    function BinanceTransport(callback) {\r\n        this.subscriptions = {};\r\n        this._connected = false;\r\n        this.cb = callback;\r\n    }\r\n    BinanceTransport.prototype.isConnected = function () {\r\n        return this._connected;\r\n    };\r\n    BinanceTransport.prototype.connect = function (symbols) {\r\n        this.init(); //Start connection\r\n    };\r\n    BinanceTransport.prototype.init = function () {\r\n        var _this = this;\r\n        this.proxy = new BinanceProxy_1.BinanceProxy();\r\n        this.proxy.on(BinanceConstant_1.BinanceConstant.OPENEVENT, function (data) {\r\n            _this._connected = true;\r\n        });\r\n        this.proxy.on(BinanceConstant_1.BinanceConstant.CLOSEEVENT, function (data) {\r\n            _this._connected = false;\r\n        });\r\n        this.proxy.on(BinanceConstant_1.BinanceConstant.ERROREVENT, function (data) {\r\n            //TODO: Error system\r\n        });\r\n        this.proxy.on(BinanceConstant_1.BinanceConstant.TICKEREVENT, function (symbol, message) {\r\n            _this.processMessage(symbol, message);\r\n        });\r\n    };\r\n    BinanceTransport.prototype.processMessage = function (symbol, message) {\r\n        if (symbol in BinanceConstant_1.BinanceConstant.PAIRS) {\r\n            var cqMsg = MsgFactory_1.MsgFactory.level1Msg;\r\n            var bestBid = Math.trunc(message.b * BinanceConstant_1.BinanceConstant.DIV) / BinanceConstant_1.BinanceConstant.DIV;\r\n            var bestAsk = Math.trunc(message.a * BinanceConstant_1.BinanceConstant.DIV) / BinanceConstant_1.BinanceConstant.DIV;\r\n            var sizeBid = Math.trunc(message.B * BinanceConstant_1.BinanceConstant.DIV) / BinanceConstant_1.BinanceConstant.DIV;\r\n            var sizeAsk = Math.trunc(message.A * BinanceConstant_1.BinanceConstant.DIV) / BinanceConstant_1.BinanceConstant.DIV;\r\n            var price = Math.trunc(message.c * BinanceConstant_1.BinanceConstant.DIV) / BinanceConstant_1.BinanceConstant.DIV;\r\n            cqMsg.buffer(MdUtils_1.MdUtils.getMsSinceMidnight(), BinanceConstant_1.BinanceConstant.PAIRS[symbol].symbol, Math.trunc(price), Math.trunc(price % 1 * BinanceConstant_1.BinanceConstant.DIV), Math.trunc(bestBid), Math.trunc(bestBid % 1 * BinanceConstant_1.BinanceConstant.DIV), Math.trunc(bestAsk), Math.trunc(bestAsk % 1 * BinanceConstant_1.BinanceConstant.DIV), MdConstant_1.MdConstant.BinanceTransport, BinanceConstant_1.BinanceConstant.PAIRS[symbol].bench);\r\n            this.cb.on(cqMsg);\r\n        }\r\n    };\r\n    return BinanceTransport;\r\n}());\r\nexports.BinanceTransport = BinanceTransport;\r\n"]}